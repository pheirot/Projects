using System;
using System.Collections.Generic;
using System.Globalization;
using System.IO;
using System.Linq;
using System.Net;
using System.Text;

using DiffPlanServer;
using Google.OrTools.Sat;
using Microsoft.AspNetCore.Mvc;
using Microsoft.Extensions.Logging;
using Newtonsoft.Json;
using WebApplication1;
using WebApplication1.entities;
using ServiceReference1;
using Newtonsoft.Json.Linq;
using System.Xml.Serialization;
using System.Runtime.Serialization.Json;

namespace WebApplication1
{

    public class LogicController : Controller
    {
        private static readonly log4net.ILog log = log4net.LogManager.GetLogger(typeof(LogicController));

        public IActionResult LotHistory()
        {
            return View();
        }

        public static DateTime StrToDate(string val)
        {
            CultureInfo enUS = new CultureInfo("en-US");
            DateTime dateValue; //"MM/dd/yyyy"
            //dateValue = DateTime.ParseExact(val, "yyyy-MM-dd", System.Globalization.CultureInfo.InvariantCulture);
            DateTime.TryParseExact(val, "yyyy-MM-dd", enUS,
                                       DateTimeStyles.AllowWhiteSpaces, out dateValue);            
            return dateValue;
        }

        #region Tests

        public dynamic GetData_test(string date, string operAgo, string batch)
        {
            WebClient client = new WebClient();

            var to = StrToDate(date).AddDays(1).ToString("yyyy-MM-dd");

            string ganttHistoryData = client.DownloadString("http://localhost:5919/DiffTests/GetHistory?from=" + date + "&to=" + to);

            return ganttHistoryData;

        }

        public dynamic GetHistoryTest(string date, string operAgo, string batch)
        {
            WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
            var rawHistoryData = client.GetHistoryAsync(StrToDate(date), StrToDate(date).AddDays(2));
            var ganttHistoryData = rawHistoryData.Result.Body.GetHistoryResult;
            return ganttHistoryData;
        }


        /*
        public string ChainsAt_stub(DateTime cutoffDate, int operAgo, int batch)
        {
            List<LotInfoJSON> ListLotInfoJSONStub = new List<LotInfoJSON>();

            for (var i = 1; i <= 4; i++)
            {
                LotInfoJSON Lot1 = new LotInfoJSON();
                Lot1.DiffRecipe = "OXIDE13";
                Lot1.FirstDiffEntityName = "FOX01";
                Lot1.Kristal = "0032";
                Lot1.Lot = "M83000" + i.ToString();
                Lot1.OperAgo = 0;
                Lot1.Paket = 112;
                Lot1.Priority = 0;
                Lot1.TargetOperation = 1120;

                LotTask lot1task1 = new LotTask();
                lot1task1.Delay = 0;
                lot1task1.Duration = 60;
                lot1task1.Entity = "WDC05";
                lot1task1.Recipe = "SPMHFRC040";
                lot1task1.Mbx = 840;
                lot1task1.Operation = 1015;
                lot1task1.paket = 0;
                lot1task1.QualAfter = lot1task1.QualBefore = 0;

                LotTask lot1task2 = new LotTask();
                lot1task2.Delay = 0;
                lot1task2.Duration = 120;
                lot1task2.Entity = "FOX01";
                lot1task2.Recipe = "OXIDE13";
                lot1task2.Mbx = 1440;
                lot1task2.Operation = 1120;
                lot1task2.paket = 112;
                lot1task2.QualAfter = lot1task2.QualBefore = 0;

                LotTask lot1task3 = new LotTask();
                lot1task3.Delay = 0;
                lot1task3.Duration = 180;
                lot1task3.Entity = "LPN02";
                lot1task3.Recipe = "NITR01";
                lot1task3.Mbx = 1440;
                lot1task3.Operation = 1180;
                lot1task3.paket = 113;
                lot1task3.QualAfter = lot1task3.QualBefore = 0;

                Lot1.Tasks = new List<LotTask> { lot1task1, lot1task2, lot1task3 };
                ListLotInfoJSONStub.Add(Lot1);
            }

            LotInfoJSON Lot5 = new LotInfoJSON();
            Lot5.DiffRecipe = "OXIDE13";
            Lot5.FirstDiffEntityName = "FOX01";
            Lot5.Kristal = "0032";
            Lot5.Lot = "M830005";
            Lot5.OperAgo = 0;
            Lot5.Paket = 5521;
            Lot5.Priority = 2;
            Lot5.TargetOperation = 1120;

            LotTask lot5task1 = new LotTask();
            lot5task1.Delay = 0;
            lot5task1.Duration = 60;
            lot5task1.Entity = "WDC05";
            lot5task1.Recipe = "SPMHFRC040";
            lot5task1.Mbx = 840;
            lot5task1.Operation = 1015;
            lot5task1.paket = 0;
            lot5task1.QualAfter = lot5task1.QualBefore = 0;

            LotTask lot5task2 = new LotTask();
            lot5task2.Delay = 0;
            lot5task2.Duration = 120;
            lot5task2.Entity = "FOX01";
            lot5task2.Recipe = "OXIDE13";
            lot5task2.Mbx = 1440;
            lot5task2.Operation = 1120;
            lot5task2.paket = 552;
            lot5task2.QualAfter = lot5task2.QualBefore = 0;

            Lot5.Tasks = new List<LotTask> { lot5task1, lot5task2 };
            ListLotInfoJSONStub.Add(Lot5);

            LotInfoJSON Lot6 = new LotInfoJSON();
            Lot6.DiffRecipe = "NITR01";
            Lot6.FirstDiffEntityName = "LPN02";
            Lot6.Kristal = "0032";
            Lot6.Lot = "M830006";
            Lot6.OperAgo = 0;
            Lot6.Paket = 6621;
            Lot6.Priority = 0;
            Lot6.TargetOperation = 1120;

            LotTask lot6task1 = new LotTask();
            lot6task1.Delay = 0;
            lot6task1.Duration = 60;
            lot6task1.Entity = "WDC05";
            lot6task1.Recipe = "SPMHFRC040";
            lot6task1.Mbx = 840;
            lot6task1.Operation = 1015;
            lot6task1.paket = 0;
            lot6task1.QualAfter = lot6task1.QualBefore = 0;

            LotTask lot6task2 = new LotTask();
            lot6task2.Delay = 0;
            lot6task2.Duration = 180;
            lot6task2.Entity = "LPN02";
            lot6task2.Recipe = "NITR01";
            lot6task2.Mbx = 1440;
            lot6task2.Operation = 1180;
            lot6task2.paket = 662;
            lot6task2.QualAfter = lot6task2.QualBefore = 0;

            LotTask lot6task3 = new LotTask();
            lot6task3.Delay = 0;
            lot6task3.Duration = 120;
            lot6task3.Entity = "FOX01";
            lot6task3.Recipe = "OXIDE13";
            lot6task3.Mbx = 1440;
            lot6task3.Operation = 1200;
            lot6task3.paket = 663;
            lot6task3.QualAfter = lot6task3.QualBefore = 0;

            Lot6.Tasks = new List<LotTask> { lot6task1, lot6task2, lot6task3 };
            ListLotInfoJSONStub.Add(Lot6);


            SetPaketFunc setPaketFunc = new SetPaketFunc();
            JsonResult resultOut = Json(setPaketFunc.SetPaket(ListLotInfoJSONStub, batch));
            return JsonConvert.SerializeObject(resultOut);
        }*/
        #endregion

        #region StringStubs
        /*
        public dynamic GetToDateData_stub(string date, int operAgo, int batch) //Данные для графика План + История
        {
            var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]},{""Lot"":""M849022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M815003"",""Priority"":0,""OperAgo"":1,""Kristal"":""0300"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41360,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41500,""Operation"":4150},{""Delay"":749,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44901,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45600,""Operation"":4560}]},{""Lot"":""M901054"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1820,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1861,""Operation"":186}]},{""Lot"":""M901055"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1862,""Operation"":186}]},{""Lot"":""M849023"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849034"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M733009"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":2409,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":230,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49402,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49450,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49900,""Operation"":4990}]},{""Lot"":""M849011"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23901,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32602,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280}]},{""Lot"":""M846011"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":164,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44902,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M846012"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":156,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2447,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842032"",""Priority"":0,""OperAgo"":5,""Kristal"":""0241"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":204,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33803,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842023"",""Priority"":0,""OperAgo"":2,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":30,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49600,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M847001"",""Priority"":0,""OperAgo"":1,""Kristal"":""0241"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":62,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":231,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849032"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22922,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M842024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M829001.2"",""Priority"":2,""OperAgo"":1,""Kristal"":""0044"",""DiffRecipe"":""OXIDE57TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B270"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE57TM"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA06F"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3396},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE58TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33972,""Operation"":3397},{""Delay"":0,""Duration"":355,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":1226,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44904,""Operation"":4490}]},{""Lot"":""M842035"",""Priority"":0,""OperAgo"":0,""Kristal"":""0241"",""DiffRecipe"":""ONO05"",""Delay"":0,""TargetOperation"":3270,""FirstDiffEntityName"":""LPN01"",""Paket"":3270,""Tasks"":[{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":3300},{""Delay"":452,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33804,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410}]},{""Lot"":""M850031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1864,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1881,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2304,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M851012"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1865,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2305,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M843022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44905,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45602,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M843035"",""Priority"":0,""OperAgo"":5,""Kristal"":""0231"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":197,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M842001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0349"",""DiffRecipe"":""MSHTO05"",""Delay"":1892,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":16,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":144,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M812007"",""Priority"":0,""OperAgo"":1,""Kristal"":""0295"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41366,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41503,""Operation"":4150},{""Delay"":734,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44906,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45603,""Operation"":4560}]},{""Lot"":""M901035.1"",""Priority"":0,""OperAgo"":2,""Kristal"":""0107"",""DiffRecipe"":""OXHT07"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13500,""Operation"":1350},{""Delay"":0,""Duration"":46,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":102,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13800,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13901,""Operation"":1390}]},{""Lot"":""M849021"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M849033"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24101,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32701,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M850025"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22801,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22923,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M901015"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901016"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901021"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901023"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M850004"",""Priority"":1,""OperAgo"":1,""Kristal"":""0367"",""DiffRecipe"":""OXHT09"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":40,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13801,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13902,""Operation"":1390},{""Delay"":1708,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC16F130"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2392}]},{""Lot"":""M902001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0323"",""DiffRecipe"":""OXIDE02"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":30,""Duration"":65,""Entity"":""WDC05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":267,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":74,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":180,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":75,""Entity"":""WDC05"",""Recipe"":""SPMHFRC040"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11204,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360}]},{""Lot"":""M733009RW"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":1241,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":182,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49406,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49451,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49904,""Operation"":4990}]},{""Lot"":""M850034"",""Priority"":0,""OperAgo"":5,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":227,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1806,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1822,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1867,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2307,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2324,""Operation"":232}]}]";

            //var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]}]";

            LotInfoJSON[] tableToDateData2 = Newtonsoft.Json.JsonConvert.DeserializeObject<LotInfoJSON[]>(stringstub);

            log.Info($"{DateTime.Now} Start transforming to Solver's data (GetGanttData)");
            EntityHistory[] output = GetPlan(tableToDateData2, date); // --->Solver--->


            log.Info($"{DateTime.Now} Start GetHistoryData: date={date}");

            var stubstringhistory = @"[{""Id"":4,""Name"":""LPN02_факт"",""FactName"":""LPN02_Факт"",""Periods"":[{""id"":38,""start"":1547172051000.0,""end"":1547192451000.0,""color"":""Blue"",""lot"":""M901015""},{""id"":39,""start"":1547172051000.0,""end"":1547192451000.0,""color"":""Blue"",""lot"":""M901016""},{""id"":40,""start"":1547172051000.0,""end"":1547192451000.0,""color"":""Blue"",""lot"":""M901021""},{""id"":41,""start"":1547172051000.0,""end"":1547192451000.0,""color"":""Blue"",""lot"":""M901023""},{""id"":98,""start"":1547263205000.0,""end"":1547283605000.0,""color"":""Blue"",""lot"":""M901024""},{""id"":99,""start"":1547263205000.0,""end"":1547283605000.0,""color"":""Blue"",""lot"":""M901025""},{""id"":100,""start"":1547263205000.0,""end"":1547283605000.0,""color"":""Blue"",""lot"":""M901026""},{""id"":101,""start"":1547263205000.0,""end"":1547283605000.0,""color"":""Blue"",""lot"":""M901045""},{""id"":121,""start"":1547298410000.0,""end"":1547317910000.0,""color"":""Blue"",""lot"":""M840035""},{""id"":122,""start"":1547298410000.0,""end"":1547317910000.0,""color"":""Blue"",""lot"":""M840036""},{""id"":123,""start"":1547298410000.0,""end"":1547317910000.0,""color"":""Blue"",""lot"":""M842001""},{""id"":124,""start"":1547298410000.0,""end"":1547317910000.0,""color"":""Blue"",""lot"":""M842023""},{""id"":147,""start"":1547322516000.0,""end"":1547340516000.0,""color"":""Blue"",""lot"":""M842024""},{""id"":148,""start"":1547322516000.0,""end"":1547340516000.0,""color"":""Blue"",""lot"":""M843022""}]},{""Id"":6,""Name"":""LPN04_факт"",""FactName"":""LPN04_Факт"",""Periods"":[{""id"":47,""start"":1547180327000.0,""end"":1547203727000.0,""color"":""Blue"",""lot"":""M842001""},{""id"":48,""start"":1547180327000.0,""end"":1547203727000.0,""color"":""Blue"",""lot"":""M842023""},{""id"":49,""start"":1547180327000.0,""end"":1547203727000.0,""color"":""Blue"",""lot"":""M842024""},{""id"":50,""start"":1547180327000.0,""end"":1547203727000.0,""color"":""Blue"",""lot"":""M843022""},{""id"":105,""start"":1547270957000.0,""end"":1547294357000.0,""color"":""Blue"",""lot"":""M840032""},{""id"":106,""start"":1547270957000.0,""end"":1547294357000.0,""color"":""Blue"",""lot"":""M843035""},{""id"":107,""start"":1547270957000.0,""end"":1547294357000.0,""color"":""Blue"",""lot"":""M843036""},{""id"":108,""start"":1547270957000.0,""end"":1547294357000.0,""color"":""Blue"",""lot"":""M845002""},{""id"":117,""start"":1547288404000.0,""end"":1547311804000.0,""color"":""Blue"",""lot"":""QMT190218""},{""id"":134,""start"":1547310331000.0,""end"":1547333731000.0,""color"":""Blue"",""lot"":""QMT190221""}]},{""Id"":8,""Name"":""LPP02_факт"",""FactName"":""LPP02_Факт"",""Periods"":[{""id"":74,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M846016""},{""id"":75,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M849011""},{""id"":76,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M849021""},{""id"":77,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M849024""},{""id"":78,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M849031""},{""id"":79,""start"":1547233344000.0,""end"":1547254944000.0,""color"":""Blue"",""lot"":""M849033""},{""id"":131,""start"":1547305044000.0,""end"":1547326644000.0,""color"":""Blue"",""lot"":""QMT190219""},{""id"":133,""start"":1547305356000.0,""end"":1547326956000.0,""color"":""Blue"",""lot"":""QMT190220""}]},{""Id"":10,""Name"":""LPP05_факт"",""FactName"":""LPP05_Факт"",""Periods"":[{""id"":155,""start"":1547328667000.0,""end"":1547349967000.0,""color"":""Blue"",""lot"":""M829001.2""}]},{""Id"":12,""Name"":""FHT01_факт"",""FactName"":""FHT01_Факт"",""Periods"":[{""id"":32,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M847001""},{""id"":33,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M849022""},{""id"":34,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M849023""},{""id"":35,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M849032""},{""id"":36,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M849034""},{""id"":37,""start"":1547170837000.0,""end"":1547198737000.0,""color"":""Blue"",""lot"":""M850025""},{""id"":69,""start"":1547211413000.0,""end"":1547230613000.0,""color"":""Blue"",""lot"":""M851001""},{""id"":149,""start"":1547322747000.0,""end"":1547350647000.0,""color"":""Blue"",""lot"":""M849014""},{""id"":150,""start"":1547322747000.0,""end"":1547350647000.0,""color"":""Blue"",""lot"":""M849015""}]},{""Id"":14,""Name"":""LPT01_факт"",""FactName"":""LPT01_Факт"",""Periods"":[{""id"":156,""start"":1547329065000.0,""end"":1547347365000.0,""color"":""Blue"",""lot"":""M812007""},{""id"":157,""start"":1547329065000.0,""end"":1547347365000.0,""color"":""Blue"",""lot"":""M812007.2""},{""id"":158,""start"":1547329065000.0,""end"":1547347365000.0,""color"":""Blue"",""lot"":""M815003""},{""id"":159,""start"":1547329065000.0,""end"":1547347365000.0,""color"":""Blue"",""lot"":""M840002""}]},{""Id"":16,""Name"":""FOX01_факт"",""FactName"":""FOX01_Факт"",""Periods"":[{""id"":59,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M846016""},{""id"":60,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M849011""},{""id"":61,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M849021""},{""id"":62,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M849024""},{""id"":63,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M849031""},{""id"":64,""start"":1547209630000.0,""end"":1547227630000.0,""color"":""Blue"",""lot"":""M849033""},{""id"":80,""start"":1547233413000.0,""end"":1547249013000.0,""color"":""Blue"",""lot"":""M901024""},{""id"":81,""start"":1547233413000.0,""end"":1547249013000.0,""color"":""Blue"",""lot"":""M901025""},{""id"":82,""start"":1547233413000.0,""end"":1547249013000.0,""color"":""Blue"",""lot"":""M901026""},{""id"":83,""start"":1547233413000.0,""end"":1547249013000.0,""color"":""Blue"",""lot"":""M901045""},{""id"":95,""start"":1547257713000.0,""end"":1547272413000.0,""color"":""Blue"",""lot"":""M829001.2""},{""id"":132,""start"":1547305276000.0,""end"":1547319676000.0,""color"":""Blue"",""lot"":""M829001.2""}]},{""Id"":18,""Name"":""FOX04_факт"",""FactName"":""FOX04_Факт"",""Periods"":[{""id"":46,""start"":1547180075000.0,""end"":1547195975000.0,""color"":""Blue"",""lot"":""M842035""},{""id"":65,""start"":1547211010000.0,""end"":1547239810000.0,""color"":""Blue"",""lot"":""M850031""},{""id"":66,""start"":1547211010000.0,""end"":1547239810000.0,""color"":""Blue"",""lot"":""M850034""},{""id"":67,""start"":1547211010000.0,""end"":1547239810000.0,""color"":""Blue"",""lot"":""M851011""},{""id"":68,""start"":1547211010000.0,""end"":1547239810000.0,""color"":""Blue"",""lot"":""M851012""},{""id"":113,""start"":1547287774000.0,""end"":1547316574000.0,""color"":""Blue"",""lot"":""M851016""},{""id"":114,""start"":1547287774000.0,""end"":1547316574000.0,""color"":""Blue"",""lot"":""M901051""},{""id"":115,""start"":1547287774000.0,""end"":1547316574000.0,""color"":""Blue"",""lot"":""M901053""},{""id"":141,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M850031""},{""id"":142,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M850034""},{""id"":143,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M851011""},{""id"":144,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M851012""},{""id"":145,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M901054""},{""id"":146,""start"":1547322428000.0,""end"":1547341628000.0,""color"":""Blue"",""lot"":""M901055""}]},{""Id"":20,""Name"":""WDC05_факт"",""FactName"":""WDC05_Факт"",""Periods"":[{""id"":51,""start"":1547188511000.0,""end"":1547191811000.0,""color"":""Blue"",""lot"":""M901045""},{""id"":52,""start"":1547188521000.0,""end"":1547191821000.0,""color"":""Blue"",""lot"":""M901024""},{""id"":53,""start"":1547188874000.0,""end"":1547192174000.0,""color"":""Blue"",""lot"":""M901026""},{""id"":54,""start"":1547188883000.0,""end"":1547192183000.0,""color"":""Blue"",""lot"":""M901025""},{""id"":135,""start"":1547313935000.0,""end"":1547318855000.0,""color"":""Blue"",""lot"":""QMW1902207""},{""id"":136,""start"":1547314043000.0,""end"":1547318963000.0,""color"":""Blue"",""lot"":""QMW1902208""},{""id"":137,""start"":1547314145000.0,""end"":1547319065000.0,""color"":""Blue"",""lot"":""QMW1902209""}]},{""Id"":22,""Name"":""WDC02_факт"",""FactName"":""WDC02_Факт"",""Periods"":[]},{""Id"":24,""Name"":""WDC03_факт"",""FactName"":""WDC03_Факт"",""Periods"":[{""id"":31,""start"":1547169219000.0,""end"":1547172219000.0,""color"":""Blue"",""lot"":""M837003""},{""id"":42,""start"":1547173363000.0,""end"":1547176663000.0,""color"":""Blue"",""lot"":""M842001""},{""id"":43,""start"":1547173372000.0,""end"":1547176672000.0,""color"":""Blue"",""lot"":""M842023""},{""id"":44,""start"":1547173682000.0,""end"":1547176382000.0,""color"":""Blue"",""lot"":""M842024""},{""id"":45,""start"":1547173695000.0,""end"":1547176395000.0,""color"":""Blue"",""lot"":""M843022""},{""id"":55,""start"":1547200520000.0,""end"":1547203280000.0,""color"":""Blue"",""lot"":""M850031""},{""id"":56,""start"":1547200528000.0,""end"":1547203288000.0,""color"":""Blue"",""lot"":""M850034""},{""id"":57,""start"":1547200772000.0,""end"":1547203532000.0,""color"":""Blue"",""lot"":""M851011""},{""id"":58,""start"":1547200780000.0,""end"":1547203540000.0,""color"":""Blue"",""lot"":""M851012""},{""id"":70,""start"":1547230588000.0,""end"":1547233288000.0,""color"":""Blue"",""lot"":""M839022""},{""id"":71,""start"":1547230598000.0,""end"":1547233298000.0,""color"":""Blue"",""lot"":""M840035""},{""id"":72,""start"":1547230855000.0,""end"":1547233555000.0,""color"":""Blue"",""lot"":""M840036""},{""id"":73,""start"":1547232378000.0,""end"":1547235378000.0,""color"":""Blue"",""lot"":""M844001""},{""id"":84,""start"":1547245224000.0,""end"":1547247984000.0,""color"":""Blue"",""lot"":""QMW1902180""},{""id"":85,""start"":1547247007000.0,""end"":1547249707000.0,""color"":""Blue"",""lot"":""M842001""},{""id"":86,""start"":1547247009000.0,""end"":1547249769000.0,""color"":""Blue"",""lot"":""QMW1902181""},{""id"":87,""start"":1547247184000.0,""end"":1547249944000.0,""color"":""Blue"",""lot"":""QMW1902182""},{""id"":88,""start"":1547247342000.0,""end"":1547250042000.0,""color"":""Blue"",""lot"":""M842023""},{""id"":89,""start"":1547247347000.0,""end"":1547250047000.0,""color"":""Blue"",""lot"":""M842001""},{""id"":90,""start"":1547249493000.0,""end"":1547253573000.0,""color"":""Blue"",""lot"":""M841023""},{""id"":91,""start"":1547249504000.0,""end"":1547253584000.0,""color"":""Blue"",""lot"":""M841021""},{""id"":92,""start"":1547252037000.0,""end"":1547254797000.0,""color"":""Blue"",""lot"":""QMW1902190""},{""id"":93,""start"":1547254912000.0,""end"":1547257672000.0,""color"":""Blue"",""lot"":""QMW1902189""},{""id"":94,""start"":1547254987000.0,""end"":1547257747000.0,""color"":""Blue"",""lot"":""QMW1902191""},{""id"":96,""start"":1547258553000.0,""end"":1547262633000.0,""color"":""Blue"",""lot"":""M842012""},{""id"":97,""start"":1547262477000.0,""end"":1547265177000.0,""color"":""Blue"",""lot"":""M845002""},{""id"":102,""start"":1547263828000.0,""end"":1547267128000.0,""color"":""Blue"",""lot"":""M843036""},{""id"":103,""start"":1547263836000.0,""end"":1547267136000.0,""color"":""Blue"",""lot"":""M843035""},{""id"":104,""start"":1547264987000.0,""end"":1547268287000.0,""color"":""Blue"",""lot"":""M840032""},{""id"":109,""start"":1547271255000.0,""end"":1547274015000.0,""color"":""Blue"",""lot"":""M901053""},{""id"":110,""start"":1547271263000.0,""end"":1547274023000.0,""color"":""Blue"",""lot"":""M851016""},{""id"":111,""start"":1547271591000.0,""end"":1547274351000.0,""color"":""Blue"",""lot"":""M901051""},{""id"":118,""start"":1547291298000.0,""end"":1547295378000.0,""color"":""Blue"",""lot"":""M843016""},{""id"":119,""start"":1547291309000.0,""end"":1547295389000.0,""color"":""Blue"",""lot"":""M833005""},{""id"":120,""start"":1547292354000.0,""end"":1547295354000.0,""color"":""Blue"",""lot"":""M837003""},{""id"":125,""start"":1547304084000.0,""end"":1547306844000.0,""color"":""Blue"",""lot"":""M850034""},{""id"":126,""start"":1547304093000.0,""end"":1547306853000.0,""color"":""Blue"",""lot"":""M850031""},{""id"":127,""start"":1547304350000.0,""end"":1547307110000.0,""color"":""Blue"",""lot"":""M851011""},{""id"":128,""start"":1547304358000.0,""end"":1547307118000.0,""color"":""Blue"",""lot"":""M851012""},{""id"":129,""start"":1547304895000.0,""end"":1547307655000.0,""color"":""Blue"",""lot"":""M901054""},{""id"":130,""start"":1547304902000.0,""end"":1547307662000.0,""color"":""Blue"",""lot"":""M901055""},{""id"":138,""start"":1547317177000.0,""end"":1547319877000.0,""color"":""Blue"",""lot"":""M840032""},{""id"":139,""start"":1547317186000.0,""end"":1547319886000.0,""color"":""Blue"",""lot"":""M843035""},{""id"":140,""start"":1547319296000.0,""end"":1547321996000.0,""color"":""Blue"",""lot"":""M843036""},{""id"":151,""start"":1547324254000.0,""end"":1547327254000.0,""color"":""Blue"",""lot"":""M812007""},{""id"":152,""start"":1547324263000.0,""end"":1547327263000.0,""color"":""Blue"",""lot"":""M812007.2""},{""id"":153,""start"":1547324508000.0,""end"":1547327508000.0,""color"":""Blue"",""lot"":""M815003""},{""id"":154,""start"":1547324516000.0,""end"":1547327516000.0,""color"":""Blue"",""lot"":""M840002""},{""id"":160,""start"":1547329234000.0,""end"":1547331994000.0,""color"":""Blue"",""lot"":""QMW1902222""},{""id"":161,""start"":1547329779000.0,""end"":1547332539000.0,""color"":""Blue"",""lot"":""QMW1902221""},{""id"":162,""start"":1547337296000.0,""end"":1547340056000.0,""color"":""Blue"",""lot"":""QMW1902219""},{""id"":163,""start"":1547337319000.0,""end"":1547340079000.0,""color"":""Blue"",""lot"":""QMW1902220""},{""id"":164,""start"":1547337379000.0,""end"":1547340139000.0,""color"":""Blue"",""lot"":""QMW1902229""},{""id"":165,""start"":1547337419000.0,""end"":1547341499000.0,""color"":""Blue"",""lot"":""M841035""},{""id"":166,""start"":1547337425000.0,""end"":1547341505000.0,""color"":""Blue"",""lot"":""M841034""}]}]";
            EntityHistory[] output2 = Newtonsoft.Json.JsonConvert.DeserializeObject<EntityHistory[]>(stubstringhistory);

            return output.Concat(output2);
        }*/

        public dynamic GetToDateTableData_stub(string date, int operAgo, int batch) //Данные для таблицы
        {
            //var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]}]";
            var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]},{""Lot"":""M849022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M815003"",""Priority"":0,""OperAgo"":1,""Kristal"":""0300"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41360,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41500,""Operation"":4150},{""Delay"":749,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44901,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45600,""Operation"":4560}]},{""Lot"":""M901054"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1820,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1861,""Operation"":186}]},{""Lot"":""M901055"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1862,""Operation"":186}]},{""Lot"":""M849023"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849034"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M733009"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":2409,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":230,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49402,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49450,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49900,""Operation"":4990}]},{""Lot"":""M849011"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23901,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32602,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280}]},{""Lot"":""M846011"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":164,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44902,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M846012"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":156,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2447,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842032"",""Priority"":0,""OperAgo"":5,""Kristal"":""0241"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":204,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33803,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842023"",""Priority"":0,""OperAgo"":2,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":30,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49600,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M847001"",""Priority"":0,""OperAgo"":1,""Kristal"":""0241"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":62,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":231,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849032"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22922,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M842024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M829001.2"",""Priority"":2,""OperAgo"":1,""Kristal"":""0044"",""DiffRecipe"":""OXIDE57TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B270"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE57TM"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA06F"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3396},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE58TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33972,""Operation"":3397},{""Delay"":0,""Duration"":355,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":1226,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44904,""Operation"":4490}]},{""Lot"":""M842035"",""Priority"":0,""OperAgo"":0,""Kristal"":""0241"",""DiffRecipe"":""ONO05"",""Delay"":0,""TargetOperation"":3270,""FirstDiffEntityName"":""LPN01"",""Paket"":3270,""Tasks"":[{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":3300},{""Delay"":452,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33804,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410}]},{""Lot"":""M850031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1864,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1881,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2304,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M851012"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1865,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2305,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M843022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44905,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45602,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M843035"",""Priority"":0,""OperAgo"":5,""Kristal"":""0231"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":197,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M842001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0349"",""DiffRecipe"":""MSHTO05"",""Delay"":1892,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":16,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":144,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M812007"",""Priority"":0,""OperAgo"":1,""Kristal"":""0295"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41366,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41503,""Operation"":4150},{""Delay"":734,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44906,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45603,""Operation"":4560}]},{""Lot"":""M901035.1"",""Priority"":0,""OperAgo"":2,""Kristal"":""0107"",""DiffRecipe"":""OXHT07"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13500,""Operation"":1350},{""Delay"":0,""Duration"":46,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":102,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13800,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13901,""Operation"":1390}]},{""Lot"":""M849021"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M849033"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24101,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32701,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M850025"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22801,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22923,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M901015"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901016"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901021"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901023"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M850004"",""Priority"":1,""OperAgo"":1,""Kristal"":""0367"",""DiffRecipe"":""OXHT09"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":40,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13801,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13902,""Operation"":1390},{""Delay"":1708,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC16F130"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2392}]},{""Lot"":""M902001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0323"",""DiffRecipe"":""OXIDE02"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":30,""Duration"":65,""Entity"":""WDC05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":267,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":74,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":180,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":75,""Entity"":""WDC05"",""Recipe"":""SPMHFRC040"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11204,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360}]},{""Lot"":""M733009RW"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":1241,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":182,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49406,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49451,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49904,""Operation"":4990}]},{""Lot"":""M850034"",""Priority"":0,""OperAgo"":5,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":227,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1806,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1822,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1867,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2307,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2324,""Operation"":232}]}]";

            LotInfoJSON[] tableToDateData2 = Newtonsoft.Json.JsonConvert.DeserializeObject<LotInfoJSON[]>(stringstub);
            log.Info($"{DateTime.Now} Finish GetToDateTableData: date={date}");
            return tableToDateData2;
        }



        #endregion

        public void SerializeAndSave(string path, List<LotInfoJSON> data)
        {

            DataContractJsonSerializer jsonFormatter = new DataContractJsonSerializer(typeof(List<LotInfoJSON>));
            //using (FileStream stream = new FileStream(@"C:\Myfile.txt", FileMode.Open, FileAccess.ReadWrite, FileShare.Read))
            using (FileStream fs = new FileStream(path, FileMode.OpenOrCreate))
            //using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.ReadWrite, FileShare.Read))
            {
                jsonFormatter.WriteObject(fs, data);
                fs.Close();
            }
        }

        public void SerializeAndSaveEH(string path, EntityHistory[] data)
        {

            DataContractJsonSerializer jsonFormatter = new DataContractJsonSerializer(typeof(EntityHistory[]));
            using (FileStream fs = new FileStream(path, FileMode.OpenOrCreate))
            {
                jsonFormatter.WriteObject(fs, data);
                fs.Close();
            }
        }

        public List<LotInfoJSON> OpenAndRead(string path, string date, int operAgo, int batch, int time)
        {
            DataContractJsonSerializer jsonFormatter = new DataContractJsonSerializer(typeof(List<LotInfoJSON>));
            List<LotInfoJSON> tableToDateData = new List<LotInfoJSON>();
            //using (FileStream stream = new FileStream(@"C:\Myfile.txt", FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
            //using (FileStream fs = new FileStream(path, FileMode.Open))
            try
            {
                using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                {
                    tableToDateData = (List<LotInfoJSON>)jsonFormatter.ReadObject(fs);
                    fs.Close();
                }
            }
            catch
            {
                WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
                var rawToDateData2 = client.ChainsAtAsync(StrToDate(date), operAgo + 1, batch, time);
                tableToDateData = rawToDateData2.Result.Body.ChainsAtResult.ToList();
            }

            return tableToDateData;
        }

        public EntityHistory[] OpenAndReadEH(string path, string date, int operAgo, int batch, int time)
        {
            DataContractJsonSerializer jsonFormatter = new DataContractJsonSerializer(typeof(EntityHistory[]));
            EntityHistory[] entityHistories = new EntityHistory[] { };

            try
            {
                using (FileStream fs = new FileStream(path, FileMode.Open, FileAccess.Read, FileShare.ReadWrite))
                {
                    entityHistories = (EntityHistory[])jsonFormatter.ReadObject(fs);
                    fs.Close();
                }
            }
            catch
            {

            }

            return entityHistories;
        }

        public string GetFilePath(string date, int operAgo, int batch, int time, string solved="")
        {
            int minutes = DateTime.Now.Hour * 60 + DateTime.Now.Minute;

            if ((time == 8 * 60) || (time == 20 * 60))
                minutes = time;

            string filename = date + "-" + operAgo.ToString() + "-" + batch.ToString() + "-" + minutes.ToString();

            string path = @"C:\Temp\" + filename + solved+ ".txt"; 
            return path;
        }

        public string SaveMessage(string name, string message)
        {
            //string path = "../Report/Report.txt";
            string path = @"C:\Temp\Feedback.txt";
            //string path = @"..\Report\Feedback.txt";
            string text = DateTime.Now.ToString()+" "+ name + " предлагает: " + message;

            using (StreamWriter sw = new StreamWriter(path, true, System.Text.Encoding.Default))
            {
                sw.WriteLine(text);                
            }      

            return "succsess";
        }

        public List<LotInfoJSON> GetCachedDataOrCreate(string date, int operAgo, int batch, int time)
        {
            string path = GetFilePath(date, operAgo, batch, time);
            List<LotInfoJSON> tableToDateData = new List<LotInfoJSON>();

            FileInfo fi1 = new FileInfo(path);

                if (!fi1.Exists)
                {
                    WipWebServiceSoapClient client2 = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
                    var rawToDateData2 = client2.ChainsAtAsync(StrToDate(date), operAgo, batch, time);
                    tableToDateData = rawToDateData2.Result.Body.ChainsAtResult.ToList();
                    SerializeAndSave(path, tableToDateData);
                }
                else
                {
                    tableToDateData = OpenAndRead(path, date, operAgo, batch, time);
                }
            

            return tableToDateData;
        }

        public EntityHistory[] GetCachedDataOrCreateEH(string date, int operAgo, int batch, int time, List<LotInfoJSON> data)
        {
            string path = GetFilePath(date, operAgo, batch, time,"solved");
            EntityHistory[] entityHistories = new EntityHistory[] { };

            FileInfo fi1 = new FileInfo(path);

            if (!fi1.Exists)
            {
                var mysolver = new MySolver();

                entityHistories = mysolver.GetSolvedTasks(data.ToArray(), date, time);
                SerializeAndSaveEH(path, entityHistories);
            }
            else
            {
                entityHistories = OpenAndReadEH(path, date, operAgo, batch, time);
            }


            return entityHistories;
        }

        public dynamic GetRawData(string date, int operAgo, int batch, int time) //Исходные данные для графика План + Факт
        {
            log.Info($"{DateTime.Now} Start GetToDateData: date={date} operAgo={operAgo+1} batch={batch}");
            List<LotInfoJSON> tableToDateData = new List<LotInfoJSON>();

            if ((time == 8 * 60) || (time == 20 * 60))
                    tableToDateData = GetCachedDataOrCreate(date, operAgo+1, batch, time);
            else
            {
                WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
                var rawToDateData2 = client.ChainsAtAsync(StrToDate(date), operAgo+1, batch, time);
                tableToDateData = rawToDateData2.Result.Body.ChainsAtResult.ToList();
            }

            //var test = tableToDateData.Where(x => x.Lot == "M851008").ToList();
            var test = tableToDateData.Where(t => t.Lot == "M906021").ToList();
            Funcs funcs = new Funcs();

            //funcs.CutChains(tableToDateData);

            tableToDateData = funcs.SetDiff(tableToDateData);
            test = tableToDateData.Where(t => t.Lot == "M906021").ToList();

            funcs.SetPaket(tableToDateData, batch, operAgo);
            tableToDateData = funcs.SetNextDiff(tableToDateData);
            test = tableToDateData.Where(t => t.Lot == "M906021").ToList();
            var json = Newtonsoft.Json.JsonConvert.SerializeObject(tableToDateData);

            return tableToDateData;
        }

        public EntityHistory[] GetPlan(string date, int operAgo, int batch, int time) //Исходные данные для графика План + Факт
        {
            log.Info($"{DateTime.Now} Start GetToDateData: date={date} operAgo={operAgo} batch={batch}");

            string path = GetFilePath(date, operAgo, batch, time);

            List<LotInfoJSON> tableToDateData = new List<LotInfoJSON>();
            
            if ((time == 8 * 60) || (time == 20 * 60))
                tableToDateData = OpenAndRead(path, date, operAgo, batch, time);
            else
            {
                WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
                var rawToDateData2 = client.ChainsAtAsync(StrToDate(date), operAgo, batch, time);
                tableToDateData = rawToDateData2.Result.Body.ChainsAtResult.ToList();
            }

            Funcs funcs = new Funcs();

            funcs.CutChains(tableToDateData);
            tableToDateData = funcs.SetDiff(tableToDateData);
            funcs.SetPaket(tableToDateData, batch, operAgo);

            //обрезаем по OperAgo
            tableToDateData = tableToDateData.Where(x => x.OperAgo <= operAgo).ToList();

            var test = tableToDateData.Where(t => t.Lot == "M913003").ToList();
            var mysolver = new MySolver();

            EntityHistory[] myanswer = new EntityHistory[] { };
            //myanswer = mysolver.GetSolvedTasks(tableToDateData.ToArray(), date, time);

            if ((time == 8 * 60) || (time == 20 * 60))
                myanswer = GetCachedDataOrCreateEH( date, operAgo + 1, batch, time, tableToDateData);
            else
            {
                myanswer = mysolver.GetSolvedTasks(tableToDateData.ToArray(), date, time);
            }

            myanswer = funcs.RemoveDoublePurge(myanswer);

            return myanswer;
        }

        public JsonResult GetPlanAndHistory(string date, int operAgo, int batch, int time) //Исходные данные для графика План + Факт
        {
            var plan = GetPlan(date, operAgo, batch, time).ToList();

            var history = GetHistory(date, time).ToList();

            List <EntityHistory> planAndHistory = history.Concat(plan).OrderBy(x=>x.Name).ToList();

            var Parents = new Parents[] { new Parents("FAL01", "FAL01"), new Parents("FOX04", "FOX04"),
                                        new Parents("FOX01", "FOX01"), new Parents("FHT01", "FHT01"),
                                        new Parents("LPT01", "LPT01"), new Parents("LPN04", "LPN04"),
                                        new Parents("LPN01", "LPN01"), new Parents("LPN02", "LPN02"),
                                        new Parents("LPP05", "LPP05"), new Parents("LPP02", "LPP02")};

            object[] o1 = new object[] { };

            o1 = o1.Concat(Parents).ToArray();
            o1 = o1.Concat(planAndHistory).ToArray();

            JsonResult j1 = Json(o1);

           return j1;
        }

        public dynamic GetTableData(string date, int operAgo, int batch, int time = 8) //Данные для таблицы
        {

            WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);
            log.Info($"{DateTime.Now} Start GetToDateTableData: date={date}");
            var rawToDateData = client.ChainsAtAsync(StrToDate(date), operAgo, batch, time);
            List <LotInfoJSON> tableToDateData = rawToDateData.Result.Body.ChainsAtResult.ToList();


            //var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]}]";
            //var stringstub = @"[{""Lot"":""M846016"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M849024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23900,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32600,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32800,""Operation"":3280}]},{""Lot"":""M850032"",""Priority"":0,""OperAgo"":4,""Kristal"":""0019"",""DiffRecipe"":"""",""Delay"":0,""TargetOperation"":232,""FirstDiffEntityName"":""LPN02"",""Paket"":230,""Tasks"":[{""Delay"":147,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2300,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2320,""Operation"":232},{""Delay"":0,""Duration"":50,""Entity"":""!NoName"",""Recipe"":""233 N/A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":233},{""Delay"":410,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2500,""Operation"":250},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE52M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":2520,""Operation"":252},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY22M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":2540,""Operation"":254}]},{""Lot"":""M849022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M815003"",""Priority"":0,""OperAgo"":1,""Kristal"":""0300"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41360,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41500,""Operation"":4150},{""Delay"":749,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44901,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45600,""Operation"":4560}]},{""Lot"":""M901054"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1820,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1861,""Operation"":186}]},{""Lot"":""M901055"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE50M"",""Delay"":0,""TargetOperation"":148,""FirstDiffEntityName"":""FOX04"",""Paket"":146,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1461,""Operation"":146},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1480,""Operation"":148},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":1500,""Operation"":150},{""Delay"":667,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1801,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1862,""Operation"":186}]},{""Lot"":""M849023"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22920,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849034"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M733009"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":2409,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":230,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49402,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49450,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49900,""Operation"":4990}]},{""Lot"":""M849011"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23901,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32602,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280}]},{""Lot"":""M846011"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":164,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44902,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M846012"",""Priority"":0,""OperAgo"":4,""Kristal"":""0107"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":156,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33802,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2447,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842032"",""Priority"":0,""OperAgo"":5,""Kristal"":""0241"",""DiffRecipe"":""OX533TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3380,""Tasks"":[{""Delay"":204,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33803,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33901,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":2583,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45200,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560}]},{""Lot"":""M842023"",""Priority"":0,""OperAgo"":2,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":30,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49600,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M847001"",""Priority"":0,""OperAgo"":1,""Kristal"":""0241"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22921,""Operation"":2292},{""Delay"":0,""Duration"":62,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":231,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M849032"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22800,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22922,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M842024"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44903,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45601,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49403,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49901,""Operation"":4990}]},{""Lot"":""M829001.2"",""Priority"":2,""OperAgo"":1,""Kristal"":""0044"",""DiffRecipe"":""OXIDE57TM"",""Delay"":0,""TargetOperation"":3390,""FirstDiffEntityName"":""FOX01"",""Paket"":3390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B270"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE57TM"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA06F"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":3396},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE58TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33972,""Operation"":3397},{""Delay"":0,""Duration"":355,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410},{""Delay"":1226,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44904,""Operation"":4490}]},{""Lot"":""M842035"",""Priority"":0,""OperAgo"":0,""Kristal"":""0241"",""DiffRecipe"":""ONO05"",""Delay"":0,""TargetOperation"":3270,""FirstDiffEntityName"":""LPN01"",""Paket"":3270,""Tasks"":[{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32801,""Operation"":3280},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":3300},{""Delay"":452,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":33804,""Operation"":3380},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OX533TM"",""QualBefore"":0,""QualAfter"":280,""Mbx"":1440,""paket"":33902,""Operation"":3390},{""Delay"":0,""Duration"":345,""Entity"":""LPP05"",""Recipe"":""POLY03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":34100,""Operation"":3410}]},{""Lot"":""M850031"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1864,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1881,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2304,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M851012"",""Priority"":0,""OperAgo"":1,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1804,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1821,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1865,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2305,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2322,""Operation"":232}]},{""Lot"":""M843022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""MSHTO05"",""Delay"":0,""TargetOperation"":4520,""FirstDiffEntityName"":""LPN04"",""Paket"":4490,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA03C"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44905,""Operation"":4490},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":4320,""paket"":45201,""Operation"":4520},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45602,""Operation"":4560},{""Delay"":816,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49601,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M843035"",""Priority"":0,""OperAgo"":5,""Kristal"":""0231"",""DiffRecipe"":""MSHTO05"",""Delay"":4631,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":197,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":252,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M842001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0349"",""DiffRecipe"":""MSHTO05"",""Delay"":1892,""TargetOperation"":4960,""FirstDiffEntityName"":""LPN04"",""Paket"":4940,""Tasks"":[{""Delay"":16,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC13C060"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49405,""Operation"":4940},{""Delay"":0,""Duration"":408,""Entity"":""LPN04"",""Recipe"":""MSHTO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49602,""Operation"":4960},{""Delay"":144,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49902,""Operation"":4990}]},{""Lot"":""M812007"",""Priority"":0,""OperAgo"":1,""Kristal"":""0295"",""DiffRecipe"":""TEO0081A"",""Delay"":0,""TargetOperation"":4145,""FirstDiffEntityName"":""LPT01"",""Paket"":4136,""Tasks"":[{""Delay"":0,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":41366,""Operation"":4136},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":41450,""Operation"":4145},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0126A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":41503,""Operation"":4150},{""Delay"":734,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":44906,""Operation"":4490},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0081A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":44950,""Operation"":4495},{""Delay"":0,""Duration"":345,""Entity"":""LPN02"",""Recipe"":""NIT0500A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":45603,""Operation"":4560}]},{""Lot"":""M901035.1"",""Priority"":0,""OperAgo"":2,""Kristal"":""0107"",""DiffRecipe"":""OXHT07"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13500,""Operation"":1350},{""Delay"":0,""Duration"":46,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":102,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13800,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT08"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13901,""Operation"":1390}]},{""Lot"":""M849021"",""Priority"":0,""OperAgo"":1,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24100,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32700,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M849033"",""Priority"":0,""OperAgo"":3,""Kristal"":""0107"",""DiffRecipe"":""OXIDE22T"",""Delay"":0,""TargetOperation"":2390,""FirstDiffEntityName"":""FOX01"",""Paket"":2390,""Tasks"":[{""Delay"":88,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385},{""Delay"":0,""Duration"":305,""Entity"":""FOX01"",""Recipe"":""OXIDE22T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":480,""paket"":23902,""Operation"":2390},{""Delay"":0,""Duration"":488,""Entity"":""LPP02"",""Recipe"":""POLY06"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":24101,""Operation"":2410},{""Delay"":2275,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":32606,""Operation"":3260},{""Delay"":0,""Duration"":715,""Entity"":""LPN01"",""Recipe"":""ONO05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":32701,""Operation"":3270},{""Delay"":0,""Duration"":373,""Entity"":""FOX04"",""Recipe"":""OXPO01"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":32802,""Operation"":3280}]},{""Lot"":""M850025"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXHT10"",""Delay"":0,""TargetOperation"":2280,""FirstDiffEntityName"":""FHT01"",""Paket"":2280,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":2270},{""Delay"":0,""Duration"":455,""Entity"":""FHT01"",""Recipe"":""OXHT10"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22801,""Operation"":2280},{""Delay"":42,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC08A200"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2290},{""Delay"":0,""Duration"":301,""Entity"":""FOX01"",""Recipe"":""OXIDE32T"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":22923,""Operation"":2292},{""Delay"":0,""Duration"":70,""Entity"":""!NoName"",""Recipe"":""PHOTOLITO"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":2300},{""Delay"":273,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2385}]},{""Lot"":""M901015"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901016"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901021"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901023"",""Priority"":0,""OperAgo"":0,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11803,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13501,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360},{""Delay"":252,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M850004"",""Priority"":1,""OperAgo"":1,""Kristal"":""0367"",""DiffRecipe"":""OXHT09"",""Delay"":0,""TargetOperation"":1350,""FirstDiffEntityName"":""FHT01"",""Paket"":1350,""Tasks"":[{""Delay"":0,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":40,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370},{""Delay"":0,""Duration"":325,""Entity"":""LPT01"",""Recipe"":""TEOS05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":13801,""Operation"":1380},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13902,""Operation"":1390},{""Delay"":1708,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC16F130"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":0,""Operation"":2392}]},{""Lot"":""M902001"",""Priority"":0,""OperAgo"":2,""Kristal"":""0323"",""DiffRecipe"":""OXIDE02"",""Delay"":0,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":30,""Duration"":65,""Entity"":""WDC05"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE02"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11203,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":267,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1HFRC09B220"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":463,""Entity"":""FHT01"",""Recipe"":""OXHT09"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":74,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1370}]},{""Lot"":""M901022"",""Priority"":0,""OperAgo"":1,""Kristal"":""0032"",""DiffRecipe"":""OXIDE13"",""Delay"":180,""TargetOperation"":1120,""FirstDiffEntityName"":""FOX01"",""Paket"":1120,""Tasks"":[{""Delay"":0,""Duration"":75,""Entity"":""WDC05"",""Recipe"":""SPMHFRC040"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":10150,""Operation"":1015},{""Delay"":0,""Duration"":303,""Entity"":""FOX01"",""Recipe"":""OXIDE13"",""QualBefore"":0,""QualAfter"":0,""Mbx"":840,""paket"":11204,""Operation"":1120},{""Delay"":0,""Duration"":333,""Entity"":""LPN02"",""Recipe"":""NITR01"",""QualBefore"":200,""QualAfter"":200,""Mbx"":0,""paket"":11804,""Operation"":1180},{""Delay"":528,""Duration"":54,""Entity"":""!NoName"",""Recipe"":""N1RCA01B"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":0,""Operation"":1340},{""Delay"":0,""Duration"":471,""Entity"":""FHT01"",""Recipe"":""OXHT07"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":13502,""Operation"":1350},{""Delay"":0,""Duration"":180,""Entity"":""!NoName"",""Recipe"":""DGFBOX04"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":0,""Operation"":1360}]},{""Lot"":""M733009RW"",""Priority"":0,""OperAgo"":5,""Kristal"":""0024"",""DiffRecipe"":""TEO0201D"",""Delay"":1241,""TargetOperation"":4945,""FirstDiffEntityName"":""LPT01"",""Paket"":4940,""Tasks"":[{""Delay"":182,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""RCA-B-MK"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":49406,""Operation"":4940},{""Delay"":0,""Duration"":327,""Entity"":""LPT01"",""Recipe"":""TEO0201D"",""QualBefore"":0,""QualAfter"":0,""Mbx"":2880,""paket"":49451,""Operation"":4945},{""Delay"":0,""Duration"":335,""Entity"":""LPN02"",""Recipe"":""NIT0100A"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":49904,""Operation"":4990}]},{""Lot"":""M850034"",""Priority"":0,""OperAgo"":5,""Kristal"":""0019"",""DiffRecipe"":""OXIDE51M"",""Delay"":0,""TargetOperation"":182,""FirstDiffEntityName"":""FOX04"",""Paket"":180,""Tasks"":[{""Delay"":227,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1806,""Operation"":180},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE51M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1822,""Operation"":182},{""Delay"":178,""Duration"":56,""Entity"":""WDC03"",""QualBefore"":0,""QualAfter"":0,""Mbx"":1440,""paket"":1867,""Operation"":186},{""Delay"":0,""Duration"":381,""Entity"":""FOX04"",""Recipe"":""OXIDE50M"",""QualBefore"":0,""QualAfter"":0,""Mbx"":0,""paket"":1882,""Operation"":188},{""Delay"":882,""Duration"":56,""Entity"":""WDC03"",""Recipe"":""N2HFRC29C055"",""QualBefore"":0,""QualAfter"":0,""Mbx"":300,""paket"":2307,""Operation"":230},{""Delay"":0,""Duration"":320,""Entity"":""LPN02"",""Recipe"":"""",""QualBefore"":0,""QualAfter"":0,""Mbx"":720,""paket"":2324,""Operation"":232}]}]";

            //LotInfoJSON[] tableToDateData2 = Newtonsoft.Json.JsonConvert.DeserializeObject<LotInfoJSON[]>(stringstub);
            log.Info($"{DateTime.Now} Finish GetToDateTableData: date={date}");

            return tableToDateData;
        }
        
        public EntityHistory[] GetHistory(string date, int time) //Получаем историю обработки
        {
            WipWebServiceSoapClient client = new WipWebServiceSoapClient(WipWebServiceSoapClient.EndpointConfiguration.WipWebServiceSoap12);

            #region Условия для from и to
            
            DateTime from = StrToDate(date);

            
            //если указана дата ранее "сегодня"
            if (from < DateTime.Now.Date )
            {                
                //from = from.AddHours(8);
                from = from.AddMinutes(time);
            }

            //если указана дата "сегодня"
            if (from.ToShortDateString() == DateTime.Now.ToShortDateString())
            {
                if (DateTime.Now.Hour >= 8 && DateTime.Now.Hour < 20)
                    from = from.AddHours(8);
                if(DateTime.Now.Hour >= 20)
                    from = from.AddHours(20);
                if (DateTime.Now.Hour < 8)
                    from = from.AddHours(-4);
            }

            DateTime to = from.AddHours(32);
            if (to > DateTime.Now) to = DateTime.Now;

            #endregion

            AutomationJob[] events = client.GetHistoryAsync(from, to).Result.Body.GetHistoryResult;

            var test = events.Where(e => e.entity == "FHT01");

            DateTime firstDate = new DateTime(1970, 1, 1, 0, 0, 0);
            List<EntityHistory> hist = new List<EntityHistory>(); ;
            string[] diffEntities = { "LPN01", "LPN02", "LPN04", "LPP02", "LPP05", "FHT01", "LPT01", "FOX01", "FOX04", "WDC05", "WDC02", "WDC03", "FAL01" };
            
            foreach (var toolName in diffEntities)
            {
                int id = 0;
                if (events.Select(x => x.entity == toolName).Count() == 0) continue;

                //decimal totalMilliseconds = (decimal)(to - from).TotalMilliseconds;

                EntityHistory entityHistory = new EntityHistory();
                entityHistory.Name = toolName + "_факт";
                entityHistory.Parent = toolName;
                entityHistory.Id = id;                

                List<AutomationJob> toolEvents = events.Where(x => x.entity == toolName).ToList();
                entityHistory.Periods = new List <LotInfoPeriodGantt>();

                foreach (AutomationJob job in toolEvents)
                {                   
                    LotInfoPeriodGantt list = new LotInfoPeriodGantt();
                    list.color = "Blue";
                    list.start = Convert.ToDouble(((DateTime)job._startDate - firstDate).TotalMilliseconds);
                    list.connectorType = "finish - start";
                    list.connectTo = "";

                    if ((job._finishDate == null) && (toolName.StartsWith("W")))
                    {
                        int duration = 50;
                        list.end = Convert.ToDouble(((DateTime)job._startDate.Value.AddMinutes(duration) - firstDate).TotalMilliseconds);
                    }
                    else if ((job._finishDate == null) && (!toolName.StartsWith("W")))
                    {
                        list.end = Convert.ToDouble((DateTime.Now - firstDate).TotalMilliseconds);                        
                    }
                    else
                    {
                        list.end = Convert.ToDouble(((DateTime)job._finishDate - firstDate).TotalMilliseconds);
                    }

                    list.lot = job.lot;
                    list.operation = job.oper.Split(' ')[0];
                    list.id = id;

                    if (!list.lot.StartsWith("M") || list.lot == null) list.color = "Yellow"; //жёлтым закрашиваем аттестации
                    if (list.lot.StartsWith("Q") || list.lot.StartsWith("R") || list.lot == null) list.color = "Violet"; // закрашиваем реставрации
                    if (list.lot.StartsWith("F")||list.lot.StartsWith("B")) list.color = "Violet"; // закрашиваем инженерные запуски

                    if (job._startDate < from)
                    {
                        list.start = Convert.ToDouble((from - firstDate).TotalMilliseconds);                        
                    }

                    if (list.end > Convert.ToDouble((to - firstDate).TotalMilliseconds)) 
                    {
                        list.end = Convert.ToDouble((to - firstDate).TotalMilliseconds);                       
                    }
                    list.recipe = job.recipe;

                    entityHistory.Periods.Add(list);
                    id++;
                }
                hist.Add(entityHistory);
            }

            return hist.ToArray();
        }        
        
    }
}
